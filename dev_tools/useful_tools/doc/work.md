# 便利店设计思路

1.caffe分类器
 使用训练好的caffe模型定义一个分类器；
2. label 
label.txt 文件中只有两类标签，即只有`background`和`person`两大类；

3.loop()
(1) 打开相机并获取图片；
(2) 建立购买区域和进出口区域；
(3) 开始loop();
 <1> 使用分类器进行人物特征识别，输出检测到的区域大小；
 <2> 绘制识别对象框的颜色是使用不同的label id索引的；
  DRAW_OBJ 区域负责的是识别到的人物的检测框绘制。
 <3> 绘制购买区域；
 <4> 开始追踪； 
 <5> 绘制进出口区域；
 
4.追踪逻辑
  
(1) 在什么情况下创建追踪器？            如果人物出现在入口区域，且是首次追踪，那么不管三七二十一直接创建一个追踪器。
(2) 在什么情况下进行矫正？如何矫正？
矫正存在的必要性：
 当人物交错出现追踪失败；
 
追踪的目的是为了随时获取购物车所有者的信息；

一旦追踪失败，会有什么后果？
  追踪失败意味着留下一个空的购物车不知道绑在谁的身上。一旦购物车找不到主人，那么最后的结算肯定失败；
 因为最后顾客走出门的时候需要结算，结算的那个人就是一直追踪的人，而购物车一定要和这个人匹配。


5.需要优化的问题
(1) 人物的检测框(或追踪框)的重叠度大于一定值的时候，如何确保追踪的准确性；
(2) 人物拿取商品操作的识别率；
(3) 商品加入顾客购物车的准确性；

## TODO工作
1.训练一个两个瓶子样本的分类器
2.训练一个通用的分类器，(foreground, background)
 通用分类器输出的结果可能会出现误判，因此需要将检测出的区域再和分类器模板进行相似度计算，这时输出的结果就会有更高的准确率。
3.使用分类器模板检测提取特征

[杜]分类器要求
1.场景固定
2.样本少量
3.训练

增广的方式：
亮度-旋转-平移-缩放-镜像-噪声-通道增益(突出/或弱化某一个通道值)


样本类别
1.普通饮料类别
2.背景类别
3.手类别
4.VOC Image

参考的轻量级网络
1.mobile net
2.lenet
3.resnet-18
4.denseNet



## 实际训练过程中的参数设置
1.学习率的设置
  一般微调时的学习率设置为0.001，不能太高，否则可能出现过拟合。

2.loss出现不正常的波动
  考虑生成样本时是否被打乱。


## 结算台
使用流程：
  提示用户放好商品(无重叠)；
  用户扫码或者扫手开始结算；
  程序开始工作；

1.ROI区域(结算台)裁剪
2.然后输入分类器进行检测和分类
3.将识别好的商品按照固定接口输出

需要讨论确定的具体需求：
1.一次结算的商品是放几排的？
2.通过视野和摄像头安装尺寸来确定结算台的大小
3.其他的视觉交互是否有需要
4.显示屏的内容



代码实现
1.label.txt的内容和行解析
2.结算的简单模拟
3.付款结账价格显示
